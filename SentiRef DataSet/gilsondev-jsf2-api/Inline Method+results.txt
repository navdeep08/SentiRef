Inline Method	Translation	Positive	Negative	EmotionRationale
4144 commit 2dea87df816e1c65876c5097a829cea6c70dbb0e restructure the logic within factoryfinder to improve concurrency. the previous version of factoryfinder would lock on the static 'applicationmap' instance thus blocking all threads on read/write operations. the 'applicationmap' was structured as:  classloader,map string,object  the map within map structure has been abstracted out to factorymanagermap which manages the mapping between a classloader and the associated factories. the factorymanagermap.getapplicationfactorymanager() leverages concurrentmap.putifabsent() to ensure that only one factorymanager instance is created for a particular classloader (without having to lock). because the factorymanager is now a self contained entity instead of just a map we can apply a per-factorymanager lock so that locking may occur only for threads accessing the same factorymanager instance. threads accessing different instances will not block each other. a simple benchmark using 10 threads, each calling setfactory() 8 times, followed by getfactory() 8 times, and then a release() (100000 times each) resulted in: old: 3.23 minutes new: 1.92 minutes unit tests ran without modified. r edburns section: modified files ---------------------------- m jsf-api/src/javax/faces/factoryfinder.java - see above - fixed an issue with the meta-inf/services discovery mechanism. the old implementation would only consider the first factory found. there could be multiple service definitions for the factory on the classpath, so ensure they are taken into account. 	4144 commit 2dea87df816e1c65876c5097a829cea6c70dbb0e restructure the logic within factoryfinder to improve concurrency.<br> the previous version of factoryfinder would lock on the static 'applicationmap' instance thus blocking all threads on read/write operations.<br> the 'applicationmap' was structured as:  classloader,map string,object  the map within map structure has been abstracted out to factorymanagermap which manages the mapping between a classloader and the associated factories.<br> the factorymanagermap.<br>getapplicationfactorymanager( leverages concurrentmap.<br>putifabsent( to ensure that only one factorymanager instance is created for a particular classloader (without having to lock)<br> because the factorymanager is now a self contained entity instead of just a map we can apply a per-factorymanager lock so that locking may occur only for threads accessing the same factorymanager instance.<br> threads accessing different instances will not block each other.<br> a simple benchmark using 10 threads, each calling setfactory( 8 times, followed by getfactory( 8 times, and then a release( (100 times each) resulted in: old: 3.23 minutes new: 1.92 minutes unit tests ran without modified.<br> are edburns section: modified files - m jsf-api/src/javax/faces/factoryfinder.<br>java - see above - fixed an issue with the meta-inf/services discovery mechanism.<br> the old implementation would only consider the first factory found.<br> there could be multiple service definitions for the factory on the classpath, so ensure they are taken into account.	2	-1	 4144[0] commit[0] 2dea87df816e1c65876c5097a829cea6c70dbb0e[0] restructure[0] the[0] logic[0] within[0] factoryfinder[0] to[0] improve[1] concurrency[0] [[Sentence=-1,2=word max, 1-5]] the[0] previous[0] version[0] of[0] factoryfinder[0] would[0] lock[0] on[0] the[0] static[0] 'applicationmap'[0] instance[0] thus[0] blocking[0] all[0] threads[0] on[0] read/write[0] operations[0] [[Sentence=-1,1=word max, 1-5]] the[0] 'applicationmap'[0] was[0] structured[0] as[0] classloader[0] map[0] string[0] object[0] the[0] map[0] within[0] map[0] structure[0] has[0] been[0] abstracted[0] out[0] to[0] factorymanagermap[0] which[0] manages[0] the[0] mapping[0] between[0] a[0] classloader[0] and[0] the[0] associated[0] factories[0] [[Sentence=-1,1=word max, 1-5]] the[0] factorymanagermap[0] [[Sentence=-1,1=word max, 1-5]] getapplicationfactorymanager[0] leverages[0] concurrentmap[0] [[Sentence=-1,1=word max, 1-5]] putifabsent[0] to[0] ensure[0] that[0] only[0] one[0] factorymanager[0] instance[0] is[0] created[0] for[0] a[0] particular[0] classloader[0] without[0] having[0] to[0] lock[0] [[Sentence=-1,1=word max, 1-5]] because[0] the[0] factorymanager[0] is[0] now[0] a[0] self[0] contained[0] entity[0] instead[0] of[0] just[0] a[0] map[0] we[0] can[0] apply[0] a[0] per[0] factorymanager[0] lock[0] so[0] that[0] locking[0] may[0] occur[0] only[0] for[0] threads[0] accessing[0] the[0] same[0] factorymanager[0] instance[0] [[Sentence=-1,1=word max, 1-5]] threads[0] accessing[0] different[0] instances[0] will[0] not[0] block[0] each[0] other[0] [[Sentence=-1,1=word max, 1-5]] a[0] simple[0] benchmark[0] using[0] 10[0] threads[0] each[0] calling[0] setfactory[0] 8[0] times[0] followed[0] by[0] getfactory[0] 8[0] times[0] and[0] then[0] a[0] release[0] (100000/(100[0][+0.6 MultipleLetters] times[0] each[0] resulted[0] in[0] old[0] 3[0] .23[0] minutes[0] new[0] 1[0] .92[0] minutes[0] unit[0] tests[0] ran[0] without[0] modified[0] [[Sentence=-1,2=word max, 1-5]] r[0] edburns[0] section[0] modified[0] files[0] m[0] jsf[0] api/src/javax/faces/factoryfinder[0] [[Sentence=-1,1=word max, 1-5]] java[0] see[0] above[0] fixed[0] an[0] issue[0] with[0] the[0] meta[0] inf/services[0] discovery[0] mechanism[0] [[Sentence=-1,1=word max, 1-5]] the[0] old[0] implementation[0] would[0] only[0] consider[0] the[0] first[0] factory[0] found[0] [[Sentence=-1,1=word max, 1-5]] there[0] could[0] be[0] multiple[0] service[0] definitions[0] for[0] the[0] factory[0] on[0] the[0] classpath[0] so[0] ensure[0] they[0] are[0] taken[0] into[0] account[0] [[Sentence=-1,1=word max, 1-5]][[[2,-1 max of sentences]]]
5124 commit fad3350bed347c4827a5facf85872a460aa540b3 [project @ 2006-07-25 21:06:03 by rlubke] -fix for issues 364 and 369 also removes dependency between commandlink and form. section: modified files m src/com/sun/faces/renderkit/renderkitutils.java - added new methods which can be leveraged by other command link type renderers * renderaddparamtoformjavascript   renders the js necessary to clear and add parameters to the form * getcommandlinkparamscript   returns a js string that can be included in an onclick handler based on the nested params of the link m src/com/sun/faces/renderkit/html_basic/buttonrenderer.java - no longer has a js requirement m src/com/sun/faces/renderkit/html_basic/commandlinkrenderer.java - leverage new functionality in renderkitutils. - instead of storing render state on the form, store it in a map keyed off the client id of the form in request scope m src/com/sun/faces/renderkit/html_basic/formrenderer.java - removed script state logic m src/com/sun/faces/renderkit/html_basic/htmlbasicrenderer.java - removed script state parameters - simplification of param inner class m src/com/sun/faces/renderkit/html_basic/outputlinkrenderer.java - takes the changes in htmlbasicrenderer into account m systest/web/golden/interweaving11.txt m systest/web/golden/regression/injectuserdefjs.txt m systest/web/golden/taglib/commandlink_multiform_test.txt m systest/web/golden/taglib/commandlink_test.txt m web/test/correctrenderersresponse m web/test/renderresponse_correct - golden file updates m systest-per-webapp/build-tests.xml m systest-per-webapp/build.xml - command-link-back-button test case is no longer valid. original author: rlubke date: 2006-07-25 21:06:11 00:00 	5124 commit fad3350bed347c4827a5facf85872a460a540b3 [project @ 2006-07-25 21:06:03 by rlubke] -fix for issues 364 and 369 also removes dependency between commandlink and form.<br> section: modified files m src/com/sun/faces/renderkit/renderkitutils.<br>java - added new methods which can be leveraged by other command link type renderers * renderaddparamtoformjavascript   renders the js necessary to clear and add parameters to the form * getcommandlinkparamscript   returns a js string that can be included in an onclick handler based on the nested params of the link m src/com/sun/faces/renderkit/html_basic/buttonrenderer.<br>java - no longer has a js requirement m src/com/sun/faces/renderkit/html_basic/commandlinkrenderer.<br>java - leverage new functionality in renderkitutils.<br> - instead of storing render state on the form, store it in a map keyed off the client id of the form in request scope m src/com/sun/faces/renderkit/html_basic/formrenderer.<br>java - removed script state logic m src/com/sun/faces/renderkit/html_basic/htmlbasicrenderer.<br>java - removed script state parameters - simplification of param inner class m src/com/sun/faces/renderkit/html_basic/outputlinkrenderer.<br>java - takes the changes in htmlbasicrenderer into account m systest/web/golden/interweaving11.<br>txt m systest/web/golden/regression/injectuserdefjs.<br>txt m systest/web/golden/taglib/commandlink_multiform_test.<br>txt m systest/web/golden/taglib/commandlink_test.<br>txt m web/test/correctrenderersresponse m web/test/renderresponse_correct - golden file updates m systest-per-webapp/build-tests.<br>xml m systest-per-webapp/build.<br>xml - command-link-back-button test case is no longer valid.<br> original author: rlubke date: 2006-07-25 21:06:11 00:00	1	-1	 5124[0] commit[0] fad3350bed347c4827a5facf85872a460aa540b3/fad3350bed347c4827a5facf85872a460a540b3[0] [project[0] @[0] 2006[0] -07[0] -25[0] 21[0] :06[0] :03[0] by[0] rlubke][0] fix[0] for[0] issues[0] 364[0] and[0] 369[0] also[0] removes[0] dependency[0] between[0] commandlink[0] and[0] form[0] [[Sentence=-1,1=word max, 1-5]] section[0] modified[0] files[0] m[0] src/com/sun/faces/renderkit/renderkitutils[0] [[Sentence=-1,1=word max, 1-5]] java[0] added[0] new[0] methods[0] which[0] can[0] be[0] leveraged[0] by[0] other[0] command[0] link[0] type[0] renderers[0] renderaddparamtoformjavascript[0] renders[0] the[0] js[0] necessary[0] to[0] clear[0] and[0] add[0] parameters[0] to[0] the[0] form[0] getcommandlinkparamscript[0] returns[0] a[0] js[0] string[0] that[0] can[0] be[0] included[0] in[0] an[0] onclick[0] handler[0] based[0] on[0] the[0] nested[0] params[0] of[0] the[0] link[0] m[0] src/com/sun/faces/renderkit/html_basic/buttonrenderer[0] [[Sentence=-1,1=word max, 1-5]] java[0] no[0] longer[0] has[0] a[0] js[0] requirement[0] m[0] src/com/sun/faces/renderkit/html_basic/commandlinkrenderer[0] [[Sentence=-1,1=word max, 1-5]] java[0] leverage[0] new[0] functionality[0] in[0] renderkitutils[0] [[Sentence=-1,1=word max, 1-5]] instead[0] of[0] storing[0] render[0] state[0] on[0] the[0] form[0] store[0] it[0] in[0] a[0] map[0] keyed[0] off[0] the[0] client[0] id[0] of[0] the[0] form[0] in[0] request[0] scope[0] m[0] src/com/sun/faces/renderkit/html_basic/formrenderer[0] [[Sentence=-1,1=word max, 1-5]] java[0] removed[0] script[0] state[0] logic[0] m[0] src/com/sun/faces/renderkit/html_basic/htmlbasicrenderer[0] [[Sentence=-1,1=word max, 1-5]] java[0] removed[0] script[0] state[0] parameters[0] simplification[0] of[0] param[0] inner[0] class[0] m[0] src/com/sun/faces/renderkit/html_basic/outputlinkrenderer[0] [[Sentence=-1,1=word max, 1-5]] java[0] takes[0] the[0] changes[0] in[0] htmlbasicrenderer[0] into[0] account[0] m[0] systest/web/golden/interweaving11[0] [[Sentence=-1,1=word max, 1-5]] txt[0] m[0] systest/web/golden/regression/injectuserdefjs[0] [[Sentence=-1,1=word max, 1-5]] txt[0] m[0] systest/web/golden/taglib/commandlink_multiform_test[0] [[Sentence=-1,1=word max, 1-5]] txt[0] m[0] systest/web/golden/taglib/commandlink_test[0] [[Sentence=-1,1=word max, 1-5]] txt[0] m[0] web/test/correctrenderersresponse[0] m[0] web/test/renderresponse_correct[0] golden[0] file[0] updates[0] m[0] systest[0] per[0] webapp/build[0] tests[0] [[Sentence=-1,1=word max, 1-5]] xml[0] m[0] systest[0] per[0] webapp/build[0] [[Sentence=-1,1=word max, 1-5]] xml[0] command[0] link[0] back[0] button[0] test[0] case[0] is[0] no[0] longer[0] valid[0] [[Sentence=-1,1=word max, 1-5]] original[0] author[0] rlubke[0] date[0] 2006[0] -07[0] -25[0] 21[0] :06[0] :11[0] 00[0] :00[0] [[Sentence=-1,1=word max, 1-5]][[[1,-1 max of sentences]]]
8730 commit 8721ecb1d2e3ee9da83bd684c3d7a8428a3d13ed [project @ 2002-03-19 19:25:01 by eburns] r visvan refactoring. section: ri changes a src/com/sun/faces/taglib/html_basic/buildcomponentfromtagimpl.java a src/com/sun/faces/treebuilder/buildcomponentfromtag.java * an instance of this class knows how to build a uicomponent instance * from a jsp tag. this allows locating this knowledge near the tag * handlers.  p  * the implementation must be modified if the tags change.  p  *  b lifetime and scope /b   p  * has the same scope as the treeengine instance. the treeengine has a * buildcomponentfromtag instance.  p  m src/com/sun/faces/treebuilder/treebuilder.java - removed tight coupling with html_basic taglib. - added use of buildcomponentfromtag interface. m src/com/sun/faces/treebuilder/treeengineimpl.java - added use of buildcomponentfromtag interface. m test/com/sun/faces/treebuilder/testtreebuilder.java - test new interface, buildcomponentfromtag. original author: eburns date: 2002-03-19 19:25:02 00:00 	8730 commit 8721ecb1d2e3ee9da83bd684c3d7a8428a3d13ed [project @ 2002-03-19 19:25:01 by eburns] are visvan refactoring.<br> section: ri changes a src/com/sun/faces/taglib/html_basic/buildcomponentfromtagimpl.<br>java a src/com/sun/faces/treebuilder/buildcomponentfromtag.<br>java * an instance of this class knows how to build a uicomponent instance * from a jsp tag.<br> this allows locating this knowledge near the tag * handlers.<br>  p  * the implementation must be modified if the tags change.<br>  p  *  b lifetime and scope /b   p  * has the same scope as the treengine instance.<br> the treengine has a * buildcomponentfromtag instance.<br>  p  m src/com/sun/faces/treebuilder/treebuilder.<br>java - removed tight coupling with html_basic taglib.<br> - added use of buildcomponentfromtag interface.<br> m src/com/sun/faces/treebuilder/treengineimpl.<br>java - added use of buildcomponentfromtag interface.<br> m test/com/sun/faces/treebuilder/testtreebuilder.<br>java - test new interface, buildcomponentfromtag.<br> original author: eburns date: 2002-03-19 19:25:02 00:00	1	-1	 8730[0] commit[0] 8721ecb1d2e3ee9da83bd684c3d7a8428a3d13ed[0] [project[0] @[0] 2002[0] -03[0] -19[0] 19[0] :25[0] :01[0] by[0] eburns][0] r[0] visvan[0] refactoring[0] [[Sentence=-1,1=word max, 1-5]] section[0] ri[0] changes[0] a[0] src/com/sun/faces/taglib/html_basic/buildcomponentfromtagimpl[0] [[Sentence=-1,1=word max, 1-5]] java[0] a[0] src/com/sun/faces/treebuilder/buildcomponentfromtag[0] [[Sentence=-1,1=word max, 1-5]] java[0] an[0] instance[0] of[0] this[0] class[0] knows[0] how[0] to[0] build[0] a[0] uicomponent[0] instance[0] from[0] a[0] jsp[0] tag[0] [[Sentence=-1,1=word max, 1-5]] this[0] allows[0] locating[0] this[0] knowledge[0] near[0] the[0] tag[0] handlers[0] [[Sentence=-1,1=word max, 1-5]] p[0] the[0] implementation[0] must[0] be[0] modified[0] if[0] the[0] tags[0] change[0] [[Sentence=-1,1=word max, 1-5]] p[0] b[0] lifetime[0] and[0] scope[0] /b[0] p[0] has[0] the[0] same[0] scope[0] as[0] the[0] treeengine/treengine[0] instance[0] [[Sentence=-1,1=word max, 1-5]] the[0] treeengine/treengine[0] has[0] a[0] buildcomponentfromtag[0] instance[0] [[Sentence=-1,1=word max, 1-5]] p[0] m[0] src/com/sun/faces/treebuilder/treebuilder[0] [[Sentence=-1,1=word max, 1-5]] java[0] removed[0] tight[0] coupling[0] with[0] html_basic[0] taglib[0] [[Sentence=-1,1=word max, 1-5]] added[0] use[0] of[0] buildcomponentfromtag[0] interface[0] [[Sentence=-1,1=word max, 1-5]] m[0] src/com/sun/faces/treebuilder/treeengineimpl/src/com/sun/faces/treebuilder/treengineimpl[0] [[Sentence=-1,1=word max, 1-5]] java[0] added[0] use[0] of[0] buildcomponentfromtag[0] interface[0] [[Sentence=-1,1=word max, 1-5]] m[0] test/com/sun/faces/treebuilder/testtreebuilder[0] [[Sentence=-1,1=word max, 1-5]] java[0] test[0] new[0] interface[0] buildcomponentfromtag[0] [[Sentence=-1,1=word max, 1-5]] original[0] author[0] eburns[0] date[0] 2002[0] -03[0] -19[0] 19[0] :25[0] :02[0] 00[0] :00[0] [[Sentence=-1,1=word max, 1-5]][[[1,-1 max of sentences]]]
